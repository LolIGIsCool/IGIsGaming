local vecspawnpositionsr = {Vector(-2808, -2493, -4859), Vector(-2809, -2280, -4859), Vector(-2812, -2055, -4859), Vector(-2808, -1741, -4859), Vector(-2807, -1559, -4859), Vector(-2809, -945, -4859), Vector(-2832, -656, -4859), Vector(-2859, -280, -4859), Vector(-2785, 80, -4859), Vector(-2795, 386, -4859), Vector(-2810, 595, -4859), Vector(-2816, 902, -4859), Vector(-2814, 1231, -4859), Vector(-3014, 1921, -4859), Vector(-2645, 1907, -4859), Vector(-2614, 829, -4859), Vector(-2303, 832, -4859), Vector(-2019, 822, -4859), Vector(-1785, 830, -4859), Vector(-1605, 801, -4859), Vector(-2048, 476, -4859), Vector(-2054, 169, -4859), Vector(-2044, -50, -4859), Vector(-2050, -228, -4859), Vector(-2049, -490, -4859), Vector(-2248, -447, -4859), Vector(-1850, -159, -4859), Vector(-2252, -159, -4859), Vector(-2439, -1374, -4859), Vector(-2210, -1375, -4859), Vector(-2003, -1396, -4859), Vector(-2120, -1436, -4859), Vector(-2073, -1682, -4859), Vector(-1922, -1748, -4859), Vector(-1678, -1701, -4859), Vector(-1685, -1503, -4859), Vector(-1712, -1170, -4859), Vector(-1703, -816, -4859), Vector(-1293, -1723, -4859), Vector(-550, -1737, -4859), Vector(-616, -1722, -4859), Vector(-389, -1729, -4859), Vector(28, -1622, -4859), Vector(-68, -1882, -4859), Vector(-178, -1747, -4859), Vector(-321, -1757, -5563), Vector(-727, -1758, -5755), Vector(-1189, -1760, -6011), Vector(-1464, -1742, -6011), Vector(-1735, -1741, -6011), Vector(-1988, -1742, -6011), Vector(-2259, -1732, -6011), Vector(-2419, -1743, -6011), Vector(-2820, -1758, -6011), Vector(-2818, -1470, -6011), Vector(-2789, -1262, -6011), Vector(-2790, -947, -6011), Vector(-2790, -734, -6011), Vector(-2790, -402, -6011), Vector(-2795, -202, -6011), Vector(-2803, 138, -6011), Vector(-2799, 370, -6011), Vector(-2797, 539, -6011), Vector(-2815, 940, -6011), Vector(-2814, 1207, -6011), Vector(-2315, 817, -6011), Vector(-2051, 810, -6011), Vector(-1750, 831, -6011), Vector(-2052, 202, -6011), Vector(-2053, -34, -6011), Vector(-2056, -307, -6011), Vector(-2050, -506, -6011), Vector(-1759, -842, -6011), Vector(-1801, -1203, -6011), Vector(-1806, -1452, -6011), Vector(-1794, -1715, -6011), Vector(589, -1771, -5563), Vector(1364, -1774, -5563), Vector(2054, -1776, -5563), Vector(3272, -1771, -5563), Vector(4040, -1808, -5563), Vector(4113, -1373, -5563), Vector(4481, -1402, -5563), Vector(5313, -1389, -5563), Vector(4085, -947, -5563), Vector(3891, -1223, -5563), Vector(3906, -810, -5371), Vector(4151, -837, -5371), Vector(4091, -1116, -5371), Vector(4076, -1716, -5195), Vector(3070, -1953, -5195), Vector(2552, -1953, -5195), Vector(1613, -1951, -5195), Vector(1539, -1843, -5195), Vector(1933, -2186, -5371), Vector(2394, -2199, -5371), Vector(3343, -2212, -5371), Vector(4495, -2202, -5371), Vector(5299, -2184, -5371), Vector(5609, -1562, -5371), Vector(5637, -1090, -5371), Vector(5676, 552, -5371), Vector(5650, 1299, -5371), Vector(5518, 1834, -5371), Vector(5122, 2191, -5371), Vector(4803, 1311, -5371), Vector(4469, 1233, -5067), Vector(4434, 969, -5067), Vector(4419, 442, -4963), Vector(4415, -265, -4963), Vector(4413, -725, -4963), Vector(4485, -959, -5067), Vector(4441, -1325, -5067), Vector(4533, -1391, -5371), Vector(4068, 1360, -5563), Vector(4528, 1342, -5563), Vector(4489, 1036, -5563), Vector(4495, 725, -5563)}
local fullvecspawnpositionsr = {Vector(-2808, -2493, -4859), Vector(-2809, -2280, -4859), Vector(-2812, -2055, -4859), Vector(-2808, -1741, -4859), Vector(-2807, -1559, -4859), Vector(-2809, -945, -4859), Vector(-2832, -656, -4859), Vector(-2859, -280, -4859), Vector(-2785, 80, -4859), Vector(-2795, 386, -4859), Vector(-2810, 595, -4859), Vector(-2816, 902, -4859), Vector(-2814, 1231, -4859), Vector(-3014, 1921, -4859), Vector(-2645, 1907, -4859), Vector(-2614, 829, -4859), Vector(-2303, 832, -4859), Vector(-2019, 822, -4859), Vector(-1785, 830, -4859), Vector(-1605, 801, -4859), Vector(-2048, 476, -4859), Vector(-2054, 169, -4859), Vector(-2044, -50, -4859), Vector(-2050, -228, -4859), Vector(-2049, -490, -4859), Vector(-2248, -447, -4859), Vector(-1850, -159, -4859), Vector(-2252, -159, -4859), Vector(-2439, -1374, -4859), Vector(-2210, -1375, -4859), Vector(-2003, -1396, -4859), Vector(-2120, -1436, -4859), Vector(-2073, -1682, -4859), Vector(-1922, -1748, -4859), Vector(-1678, -1701, -4859), Vector(-1685, -1503, -4859), Vector(-1712, -1170, -4859), Vector(-1703, -816, -4859), Vector(-1293, -1723, -4859), Vector(-550, -1737, -4859), Vector(-616, -1722, -4859), Vector(-389, -1729, -4859), Vector(28, -1622, -4859), Vector(-68, -1882, -4859), Vector(-178, -1747, -4859), Vector(-321, -1757, -5563), Vector(-727, -1758, -5755), Vector(-1189, -1760, -6011), Vector(-1464, -1742, -6011), Vector(-1735, -1741, -6011), Vector(-1988, -1742, -6011), Vector(-2259, -1732, -6011), Vector(-2419, -1743, -6011), Vector(-2820, -1758, -6011), Vector(-2818, -1470, -6011), Vector(-2789, -1262, -6011), Vector(-2790, -947, -6011), Vector(-2790, -734, -6011), Vector(-2790, -402, -6011), Vector(-2795, -202, -6011), Vector(-2803, 138, -6011), Vector(-2799, 370, -6011), Vector(-2797, 539, -6011), Vector(-2815, 940, -6011), Vector(-2814, 1207, -6011), Vector(-2315, 817, -6011), Vector(-2051, 810, -6011), Vector(-1750, 831, -6011), Vector(-2052, 202, -6011), Vector(-2053, -34, -6011), Vector(-2056, -307, -6011), Vector(-2050, -506, -6011), Vector(-1759, -842, -6011), Vector(-1801, -1203, -6011), Vector(-1806, -1452, -6011), Vector(-1794, -1715, -6011), Vector(589, -1771, -5563), Vector(1364, -1774, -5563), Vector(2054, -1776, -5563), Vector(3272, -1771, -5563), Vector(4040, -1808, -5563), Vector(4113, -1373, -5563), Vector(4481, -1402, -5563), Vector(5313, -1389, -5563), Vector(4085, -947, -5563), Vector(3891, -1223, -5563), Vector(3906, -810, -5371), Vector(4151, -837, -5371), Vector(4091, -1116, -5371), Vector(4076, -1716, -5195), Vector(3070, -1953, -5195), Vector(2552, -1953, -5195), Vector(1613, -1951, -5195), Vector(1539, -1843, -5195), Vector(1933, -2186, -5371), Vector(2394, -2199, -5371), Vector(3343, -2212, -5371), Vector(4495, -2202, -5371), Vector(5299, -2184, -5371), Vector(5609, -1562, -5371), Vector(5637, -1090, -5371), Vector(5676, 552, -5371), Vector(5650, 1299, -5371), Vector(5518, 1834, -5371), Vector(5122, 2191, -5371), Vector(4803, 1311, -5371), Vector(4469, 1233, -5067), Vector(4434, 969, -5067), Vector(4419, 442, -4963), Vector(4415, -265, -4963), Vector(4413, -725, -4963), Vector(4485, -959, -5067), Vector(4441, -1325, -5067), Vector(4533, -1391, -5371), Vector(4068, 1360, -5563), Vector(4528, 1342, -5563), Vector(4489, 1036, -5563), Vector(4495, 725, -5563)}
util.AddNetworkString("christmassoundmeme")

local function randomrewardmeme(pool)
    local poolsize = 0

    for k, v in ipairs(pool) do
        poolsize = poolsize + v[1]
    end

    local selection = math.random(1, poolsize)

    for k, v in ipairs(pool) do
        selection = selection - v[1]
        if (selection <= 0) then return v[2] end
    end
end

function SpawnIGPresents()
    for i = 1, 5 do
        timer.Simple(math.random(1, 280), function()
            print("[IG-PRESENTS] spawning present")
            local ID1 = randomrewardmeme({{33, "points"}, {33, "credits"}, {33, "xp"}, {1, "special"}})
            local ID = randomrewardmeme(IGRandomTable[ID1])
            local vecPos = table.Random(vecspawnpositionsr)
            table.RemoveByValue(vecspawnpositionsr, vecPos)
            local thepresent = ents.Create("ig_present")
            thepresent:SetPos(vecPos)
            thepresent:Spawn()
            thepresent:DropToFloor()
            thepresent:SetModel("models/griim/christmas/present_colourable.mdl")
            thepresent:SetOpened(false)
            thepresent:SetReward(ID)
            thepresent:SetColor(IGPresentTable[ID]["Colour"])
        end)
    end
end

function MassSpawnIGPresents()
    vecspawnpositionsr = table.Copy(fullvecspawnpositionsr)
    for i = 1, 15 do
        timer.Simple(math.random(1, 60), function()
            print("[IG-PRESENTS] spawning present")
            local ID1 = randomrewardmeme({{33, "points"}, {33, "credits"}, {33, "xp"}, {1, "special"}})
            local ID = randomrewardmeme(IGRandomTable[ID1])
            local vecPos = table.Random(vecspawnpositionsr)
            table.RemoveByValue(vecspawnpositionsr, vecPos)
            local thepresent = ents.Create("ig_present")
            thepresent:SetPos(vecPos)
            thepresent:Spawn()
            thepresent:DropToFloor()
            thepresent:SetModel("models/griim/christmas/present_colourable.mdl")
            thepresent:SetOpened(false)
            thepresent:SetReward(ID)
            thepresent:SetColor(IGPresentTable[ID]["Colour"])
        end)
    end
end

timer.Create("SpawnPresentsLel", 800, 0, function()
    --[[local playercnt = player.GetCount()
    local mapcur = game.GetMap()
    local chancer = math.random(1, 100)

    if (playercnt >= 20 and string.match(mapcur, "stardestroyer") and not getdiseasesys) then
        if chancer <= 10 then
            MassSpawnIGPresents()
            net.Start("christmassoundmeme")
            net.Broadcast()

            for k, v in ipairs(player.GetAll()) do
                v:QUEST_SYSTEM_ChatNotify("Presents", "Santas Sleigh can be heard in the distance....")
                v:QUEST_SYSTEM_ChatNotify("Presents", "Santa is feeling generous this time, frenzy time!")
            end
        else
            SpawnIGPresents()
            net.Start("christmassoundmeme") 
            net.Broadcast()

            for k, v in ipairs(player.GetAll()) do
                v:QUEST_SYSTEM_ChatNotify("Presents", "Santas Sleigh can be heard in the distance....")
            end
        end
    end]]
end)

concommand.Add("debugspawnprezzie", function(ply)
    if not ply:IsSuperAdmin() then return end
    local ID1 = randomrewardmeme({{33, "points"}, {33, "credits"}, {33, "xp"}, {1, "special"}})
    local ID = randomrewardmeme(IGRandomTable[ID1])
    local thepresent = ents.Create("ig_present")
    thepresent:SetPos(ply:GetEyeTrace().HitPos)
    thepresent:Spawn()
    thepresent:DropToFloor()
    thepresent:SetModel("models/griim/christmas/present_colourable.mdl")
    thepresent:SetOpened(false)
    thepresent:SetReward(ID)
    thepresent:SetColor(IGPresentTable[ID]["Colour"])
end)

concommand.Add("debugspawnprezzies", function(ply)
    if not ply:IsSuperAdmin() then return end
    ply:ChatPrint("spawning presents")
    vecspawnpositionsr = table.Copy(fullvecspawnpositionsr)
    SpawnIGPresents()
end)

concommand.Add("debugspawnprezzies2", function(ply)
    vecspawnpositionsr = table.Copy(fullvecspawnpositionsr)

    for k, v in pairs(player.GetAll()) do
        v:QUEST_SYSTEM_ChatNotify("Presents", "Before santa leaves he has decided to deliver a lot of presents, enjoy!")
        print("Before santa leaves he has decided to deliver a lot of presents, enjoy!")
    end

    net.Start("christmassoundmeme")
    net.Broadcast()

    for i = 1, 10 do
        SpawnIGPresents()
        print("spawnigpresents()")
    end
end)